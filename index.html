<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Dashboard Notes</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-slate-100 to-slate-200 min-h-screen p-8">

  <div class="max-w-4xl mx-auto">

    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-slate-800">ðŸ“Š Dashboard Notes</h1>
      <p class="text-slate-500">Calcul automatique selon une formule fixe</p>
    </div>

    <!-- Statistiques -->
    <div class="grid grid-cols-2 gap-6 mb-8">
      <div class="bg-white p-6 rounded-2xl shadow-md transition hover:shadow-xl">
        <p class="text-slate-500 text-sm">Nombre de notes</p>
        <h2 id="totalNotes" class="text-2xl font-bold text-slate-800">0</h2>
      </div>

      <div class="bg-white p-6 rounded-2xl shadow-md transition hover:shadow-xl">
        <p class="text-slate-500 text-sm">Moyenne calculÃ©e</p>
        <h2 id="average" class="text-2xl font-bold text-blue-600">0,00</h2>
      </div>
    </div>

    <!-- Contenu principal -->
    <div class="grid md:grid-cols-2 gap-8">

      <!-- Formule + Ajout -->
      <div class="bg-white p-6 rounded-2xl shadow-md">
        <h2 class="font-semibold text-slate-700 mb-4">ParamÃ¨tres</h2>

        <label class="block text-sm text-slate-600 mb-1">Formule (ex: 15/31)</label>
        <input type="text" id="formula"
          class="w-full px-4 py-2 border rounded-xl mb-4 focus:ring-2 focus:ring-blue-400 focus:outline-none transition"
          placeholder="Ex: 15/31">

        <form id="noteForm">
          <label class="block text-sm text-slate-600 mb-1">Note</label>
          <input type="number" step="any" id="note" required
            class="w-full px-4 py-2 border rounded-xl mb-4 focus:ring-2 focus:ring-blue-400 focus:outline-none transition"
            placeholder="Ex: 14">

          <button type="submit"
            class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-xl transition duration-300 transform hover:scale-105">
            Ajouter
          </button>
        </form>
      </div>

      <!-- Liste -->
      <div class="bg-white p-6 rounded-2xl shadow-md">
        <h2 class="font-semibold text-slate-700 mb-4">RÃ©sultats</h2>
        <div id="results" class="space-y-3 max-h-96 overflow-y-auto">
        </div>
      </div>

    </div>

  </div>

<script>
  const formulaInput = document.getElementById("formula");
  const noteForm = document.getElementById("noteForm");
  const resultsDiv = document.getElementById("results");
  const totalNotesEl = document.getElementById("totalNotes");
  const averageEl = document.getElementById("average");

  let numerator = null;
  let denominator = null;
  let resultsArray = [];

  // Mise Ã  jour formule
  formulaInput.addEventListener("change", function () {
    const formula = formulaInput.value.trim();

    if (!formula.includes("/")) return;

    const parts = formula.split("/");
    numerator = parseFloat(parts[0]);
    denominator = parseFloat(parts[1]);

    if (isNaN(numerator) || isNaN(denominator) || denominator === 0) {
      numerator = null;
      denominator = null;
    }
  });

  // Ajout note
  noteForm.addEventListener("submit", function (e) {
    e.preventDefault();

    if (numerator === null || denominator === null) {
      alert("Veuillez entrer une formule valide.");
      return;
    }

    const note = parseFloat(document.getElementById("note").value);
    if (isNaN(note)) return;

    const result = note * (numerator / denominator);
    resultsArray.push(result);

    addResultToUI(note, result);
    updateStats();

    noteForm.reset();
  });

  function addResultToUI(note, result) {
    const formattedResult = result.toFixed(2).replace(".", ",");

    const row = document.createElement("div");
    row.className = `
      flex justify-between items-center 
      bg-slate-50 px-4 py-3 rounded-xl border
      opacity-0 translate-y-3
      transition-all duration-500
    `;

    row.innerHTML = `
      <span class="font-medium text-slate-700">${note}</span>
      <span class="font-semibold text-blue-600">${formattedResult}</span>
    `;

    resultsDiv.prepend(row);

    // Animation apparition
    setTimeout(() => {
      row.classList.remove("opacity-0", "translate-y-3");
    }, 50);
  }

  function updateStats() {
    totalNotesEl.textContent = resultsArray.length;

    const sum = resultsArray.reduce((a, b) => a + b, 0);
    const avg = sum / resultsArray.length;

    averageEl.textContent = avg.toFixed(2).replace(".", ",");
  }
</script>

</body>
</html>
